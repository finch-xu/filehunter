[server]
bind = "0.0.0.0:8080"

# --- All fields below are optional (shown values are defaults) ---

# Enable HTTP/1.1 keep-alive.
# keepalive = true

# Maximum connection lifetime in seconds (0 = unlimited).
# Protects against slow-loris and idle connections.
# connection_timeout = 300

# Maximum size for the request line + headers.
# Supports: "8KB", "16KB", or raw bytes like 8192
# max_header_size = "8KB"

# Maximum number of request headers.
# max_headers = 64

# Maximum allowed Content-Length. Requests exceeding this get 413.
# Supports: "1MB", "512KB", "2GB", or raw bytes like 1048576
# max_body_size = "1MB"

# HTTP/2 maximum concurrent streams per connection.
# http2_max_streams = 128

# Maximum file size that can be served. Files exceeding this are skipped.
# Set to 0 to disable the limit.
# Supports: "10MB", "100MB", "1GB", or raw bytes
# max_file_size = "10MB"

# Response streaming buffer size.
# Supports: "64KB", "128KB", or raw bytes like 65536
# stream_buffer_size = "64KB"

# ---------------------------------------------------------------------------
# Locations — each [[locations]] maps a URL prefix to search paths.
#
# Search mode per location: "sequential" (default), "concurrent", or "latest_modified".
#   sequential      — check roots one-by-one in config order; first match wins.
#   concurrent      — probe all eligible roots at the same time; fastest match wins,
#                     remaining searches are cancelled immediately.
#   latest_modified — check all roots and return the file with the most recent
#                     modification time.
#
# Each location can optionally override the server-level max_file_size.
# If omitted, the location inherits the global [server].max_file_size.
#
# Each location has its own paths with optional extensions filter.
# If extensions is omitted or empty, all file types are allowed.
# Requests that don't match any location prefix return 404.
# ---------------------------------------------------------------------------

# Example: single catch-all location (simplest setup)
[[locations]]
prefix = "/"

[[locations.paths]]
root = "/data/images"
extensions = ["jpg", "jpeg", "png", "gif", "webp", "svg", "bmp", "ico"]

[[locations.paths]]
root = "/data/documents"
extensions = ["pdf", "docx", "xlsx", "pptx", "doc", "xls", "ppt", "txt", "csv"]

[[locations.paths]]
root = "/data/videos"
extensions = ["mp4", "mkv", "avi", "mov", "wmv", "flv", "webm"]

[[locations.paths]]
root = "/data/general"
# No extensions filter — accepts any file type as a catch-all fallback.

# Example: multi-prefix routing (uncomment to use)
#
# [[locations]]
# prefix = "/imgs"
# mode = "sequential"
# # No max_file_size → inherits server-level default (10MB)
#
# [[locations.paths]]
# root = "/data/path1"
# extensions = ["jpg", "png", "webp"]
#
# [[locations.paths]]
# root = "/data/path2"
# extensions = ["jpg", "png", "webp"]
#
# [[locations]]
# prefix = "/videos"
# mode = "concurrent"
# max_file_size = "500MB"       # Override: allow large video files
#
# [[locations.paths]]
# root = "/data/videos"
# extensions = ["mp4", "mkv", "webm"]
#
# [[locations]]
# prefix = "/pdf"
# mode = "concurrent"
# max_file_size = "50MB"        # Override: PDFs up to 50MB
#
# [[locations.paths]]
# root = "/data/pdf-store"
# extensions = ["pdf"]
